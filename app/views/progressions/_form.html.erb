<%= model_form_with model: progression, class: "progression-form", id: progressions_form_id(progression), local: false do |form| %>
    <%= render "progressions/errors", progression: progression %>
    <%= render "progressions/fields", form: form %>
    <%= tag.div class: "progression-print" do %>
        <%= tag.h2 progression.print, class: "progression-print" %>
    <% end %>
    <%= render "progressions/chords", form: form, progression: progression %>
    
    <%# if uid local variable assigned, create a hidden field so that the controller can target this form in its response %>
    <% if defined? uid %>
        <%= form.hidden_field :uid, value: uid.to_s %>
    <% end %>

    <%# track the song that this progression was created for %>
    <% if defined? song %>
        <%= form.hidden_field :song_id, value: song.id %>
    <% end %>

    <%= turbo_link_button t('actions.add', thing: t('models.progression_chord.model_name')), new_progression_chord_path(id: progression.id || 0.to_s) %>
    
    <% unless progression.new_record? %>
        <%= turbo_link_button t('actions.copy', thing: t('models.progression.model_name')), new_progression_path(progression_id: progression.id) %>
        <%= link_to t('actions.delete', thing: t('models.progression.model_name')), progression_path(progression.id), class: "button button--alert", data: { turbo_method: :delete, turbo_confirm: t('confirm.delete', model: t('models.progression.model_name')) } %>
    <% end %>

    <% if progression.id == nil %>
        <%= form.submit t('actions.create', thing: t('models.progression.model_name')) %>
    <% else %>
        <%= form.submit t('actions.update', thing: t('models.progression.model_name')) %>
    <% end %>
<% end %>
