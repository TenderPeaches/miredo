<%= form_with model: song_progression, url: song_progressions_path(song_id: song_progression.song), class: "song-progression-form", id: "#{dom_id(song_progression)}__form" do |form| %>
    <%= render "song_progressions/errors", song_progression: song_progression %>
    <%= tag.div class: "progression-template-print" do %>
        <%= tag.div "#{song_progression.progression_template.print(song.key, song.scale)}" %>
    <% end %>
    <%= render "song_progressions/fields", form: form %>

    <%# if uid local variable assigned, create a hidden field so that the controller can target this form in its response %>
    <% if defined? uid %>
        <%= form.hidden_field :uid, value: uid.to_s %>
    <% end %>

    <%= form.hidden_field :song_id, value: song.id %>

    <% unless song_progression.new_record? %>
        <%= link_to t('actions.delete', thing: t('models.song_progression.model_name')), song_progression_path(song_progression.id), class: "button button--alert", data: { turbo_method: :delete, turbo_confirm: t('confirm.delete', model: t('models.song_progression.model_name')) } %>
    <% end %>

    <% if song_progression.id == nil %>
        <%= form.submit t('actions.create', thing: t('models.song_progression.model_name')) %>
    <% else %>
        <%= form.submit t('actions.update', thing: t('models.song_progression.model_name')) %>
    <% end %>
<% end %>
