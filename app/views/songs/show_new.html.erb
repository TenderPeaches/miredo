<!-- to be used with songs whose structure is dictated by SongProgression entities, rather than plaintext -->
<div class="show-song">
    <%= link_to "< Back", "/", class: "button" %>
    <%= link_to "Play", "/play/" << @song.id.to_s, class: "button" %>
    <%= link_to "Edit", "/edit/" << @song.id.to_s, class: "button" %>
    <%= form_with(url: "/show_new/" + @song.id.to_s + "?capo=" + "") do |form| %>
        <h1>#<%= @song.id %>: <%= @song.get_artists %> - <%= @song.name %></h1>
        <div>Key: <%= @key.shorthand %></div>
        <div>
            <%= form.label :capo, "Capo:" %>
        <%= form.select :capo, options_for_select([-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], selected: @song.capo) %>
        </div>
        <%= form.submit "Apply" %>
    <% end %>

    <% @song.song_progressions.order(:sequence).each do |song_progression| %>
        <div class="song-progression__chords">
            <% song_progression.progression.progression_chords.order(:sequence).each do |progression_chord| %>
                <%= progression_chord.print(@song.key, @song.scale) %> 
            <% end %>
            <% unless song_progression.nil? %>
                <% if song_progression.reps > 1 %>
                    <%= song_progression.print_reps %>
                <% end %>
            <% end %>
        </div>
        <div class="song-progression__lyrics">
            <%= raw song_progression.html_lyrics %>
        </div>
    <% end %>
</div>