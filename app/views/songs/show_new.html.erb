<!-- to be used with songs whose structure is dictated by SongProgression entities, rather than plaintext -->
 <%# options_panel %>
    <%= tag.div class: "options-panel" do %>
        <%= link_to "< Back", "/", class: "button" %>
        <%= link_to "Edit", "/edit/" << @song.id.to_s, class: "button" %>
        <%= link_to "Progressions", song_progressions_path(@song), class: "button" %>
        <%= link_to "Song Progressions", song_song_progressions_path(@song), class: "button" %>
        <%= link_to 'Random', song_path(Song.random_id), class: "button" %>
    <% end %>
    <%= form_tag song_path(@song.id), method: :get do %>
        <%= tag.div class: "title" do %>
            <% if @song.id > 1 %>
                <%= link_to "<", "/songs/" << (@song.id - 1).to_s, class: "button" %>
            <% end %>
            <h1>#<%= @song.id %>: <%= @song.get_artists %> - <%= @song.name %></h1>
            <% if @song.id < Song.last.id %>
                <%= link_to ">", "/songs/" << (@song.id + 1).to_s, class: "button" %>
            <% end %>
        <% end %>
        <div>Key: <%= @key.shorthand %></div>
        <%= tag.div do %>
            <%= label_tag :capo, "Capo:" %>
            <%= select_tag :capo, options_for_select([-1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10], selected: @capo) %>
            <%= tag.div do %>
                <%= label_tag :key_shift, "Shift key:" %>
                <%= number_field_tag :key_shift, @key_shift || 0, in: -6...7 %>
            <% end %>
            <%= tag.div id: "song-play-count" do %>
                <%= t('models.song.practiced', times: @song.nb_practices.to_s) %>
            <% end %>
        <% end %>
        <%= submit_tag "Apply" %>
        <%= turbo_link_button "Play", play_song_path(@song.id) %>  
        <%= %>
    <% end %>
    <%= tag.div class: "song-top-panel" do %>
        <%= render "scales/print", scale: @song.scale, key: @key %> 
        <%= tag.div id: "instruments", class: "instruments" do %>
            <%= render "instruments/piano/keys", song: @song, scale_pitch_ids: @key_pitch_ids %>
            <%= render "instruments/guitar/fretboard", key: @key, scale: @scale, tuning: @tuning, frets: @frets, capo: @capo, accepted_pitch_ids: @key_pitch_ids %>
        <% end %>
    <% end %>
<%= tag.div class: "show-song", data: { controller: "show-song" } do %> 
    <%= Songs::Printer.new(@song, @key_with_capo, @song.scale).print %>
<% end %>